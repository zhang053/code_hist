在处理用户界面自动化测试时，鼠标操作是不可或缺的一部分。Playwright提供了丰富的鼠标操作API，包括点击、双击、拖拽、滚动等，使得模拟用户交互变得更加简单和灵活。

### 16.1.1 鼠标操作
#### 1）鼠标点击：
```python
# 鼠标点击
page.mouse.click(100, 200, button='left', click_count=1, delay=0)
```

**参数**

+ `<font style="background-color:rgb(243, 244, 244);">x</font>` ：X轴位置
+ `<font style="background-color:rgb(243, 244, 244);">y</font>` ：Y轴位置
+ `<font style="background-color:rgb(243, 244, 244);">button</font>`： `<font style="background-color:rgb(243, 244, 244);">left</font>` 、`<font style="background-color:rgb(243, 244, 244);">right</font>` 、`<font style="background-color:rgb(243, 244, 244);">middle</font>`
+ `<font style="background-color:rgb(243, 244, 244);">click_count</font>` : 点击次数，默认值为 1。
+ `<font style="background-color:rgb(243, 244, 244);">delay</font>` ：点击按下到释放的时间（以毫秒为单位）

#### 2）鼠标双击
```python
page.mouse.dblclick(x, y)
```

**参数**

+ `<font style="background-color:rgb(243, 244, 244);">x</font>` ：X轴位置
+ `<font style="background-color:rgb(243, 244, 244);">y</font>` ：Y轴位置
+ `<font style="background-color:rgb(243, 244, 244);">button</font>`： `<font style="background-color:rgb(243, 244, 244);">left</font>` 、`<font style="background-color:rgb(243, 244, 244);">right</font>` 、`<font style="background-color:rgb(243, 244, 244);">middle</font>`
+ `<font style="background-color:rgb(243, 244, 244);">click_count</font>` : 点击次数，默认值为 1。
+ `<font style="background-color:rgb(243, 244, 244);">delay</font>` ：点击按下到释放的时间（以毫秒为单位）

#### 3）按下鼠标
```python
page.mouse.down()
```

**参数**

+ `<font style="background-color:rgb(243, 244, 244);">x</font>` ：X轴位置
+ `<font style="background-color:rgb(243, 244, 244);">y</font>` ：Y轴位置
+ `<font style="background-color:rgb(243, 244, 244);">button</font>`： `<font style="background-color:rgb(243, 244, 244);">left</font>` 、`<font style="background-color:rgb(243, 244, 244);">right</font>` 、`<font style="background-color:rgb(243, 244, 244);">middle</font>`

#### 4）移动鼠标
```python
page.mouse.move()
```

**参数**

+ `<font style="background-color:rgb(243, 244, 244);">x</font>` ：X轴位置
+ `<font style="background-color:rgb(243, 244, 244);">y</font>` ：Y轴位置

#### 5）释放鼠标
```python
page.mouse.up()
```

**参数**

+ `<font style="background-color:rgb(243, 244, 244);">button</font>`： `<font style="background-color:rgb(243, 244, 244);">left</font>` 、`<font style="background-color:rgb(243, 244, 244);">right</font>` 、`<font style="background-color:rgb(243, 244, 244);">middle</font>`
+ `<font style="background-color:rgb(243, 244, 244);">click_count</font>` : 点击次数，默认值为 1。

#### 6）元素拖拽综合方法
```python
page.drag_and_drop('//*[@id="box22"]','//*[@id="box11"]')
```

参数：

+ 拖拽元素的定位表达式
+ 目标元素的定位表达式

#### 7）鼠标滚轮滚动
```python
page.mouse.wheel(delta_x, delta_y)
```

**参数**

+ `<font style="background-color:rgb(243, 244, 244);">delta_x</font>` : 要水平滚动的像素。
+ `<font style="background-color:rgb(243, 244, 244);">delta_y</font>` : 要垂直滚动的像素。



### 16.1.2 鼠标拖拽案例
接下来，我们通过一个具体的拖拽案例来演示如何使用Playwright进行元素拖拽操作

#### 1）演示网页代码
```python
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>拖拽案例</title>
  <link rel="stylesheet" href="https://apps.bdimg.com/libs/jqueryui/1.10.4/css/jquery-ui.min.css">
  <style>
  #box22 {
    width: 100px;
    height: 100px;
    background: #4d8d3b;
    border-radius: 10px;
    box-shadow: 0 0 5px #4d8d3b;
    index:999
  }
  #box11 {
    position: absolute;
    left: 500px;
    top: 200px;
    width: 125px;
    height: 125px;
    background: #db3838;
    color: #fff;
    border-radius: 10px;
    box-shadow: 0 0 5px #db3838;
    padding: 10px;
  }
  </style>
  <script src="https://apps.bdimg.com/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src="https://apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
</head>
<body>
 
<div id="box11">小红</div>
<div id="box22">小绿</div>
 
<script>
$( "#box11" ).draggable();
$( "#box22" ).draggable();
$( "#box11" ).droppable({
  drop: function() {
    alert( "小绿,你挡住我啦" );
  }
});
</script>
 
</body>
</html>
```

#### 2）Playwright拖拽示例
```python
 from playwright.sync_api import sync_playwright

   with sync_playwright() as p:
       browser = p.chromium.launch(headless=False)
       page = browser.new_page()
       page.goto('file:///path/to/your/drag_drop_example.html')
       page.wait_for_timeout(2000)  # 等待页面加载

       # 拖拽元素
       page.drag_and_drop('//*[@id="box22"]', '//*[@id="box11"]')

       browser.close()
```

通过这个案例，我们可以看到如何使用`page.drag_and_drop`方法来实现元素的拖拽操作，并触发相应的事件。

### 16.1.3 键盘操作
除了鼠标操作，键盘操作也是不可或缺的一部分。Playwright提供了丰富的键盘操作API，包括按下、松开、输入文本等，使得模拟用户键盘输入变得更加简单和灵活。

#### 1）按下键盘按键
+ `<font style="background-color:rgb(243, 244, 244);">keyboard.down()</font>`

```python
keyboard.down('Enter')
```

**参数**

+ `<font style="background-color:rgb(243, 244, 244);">key</font>` : 要按下的键的名称或要生成的字符

#### 2）松开键盘按键
```python
keyboard.up('ArrowLeft')
```

**参数**

+ `<font style="background-color:rgb(243, 244, 244);">key</font>` : 要按下的键的名称或要生成的字符

#### 3）按下并松开按键
+ `<font style="background-color:rgb(243, 244, 244);">keyboard.press()</font>`

按键盘按键`keyboard.down()`,`keyboard.up()` 的组合方式。

```python
from playwright.sync_api import sync_playwright

with sync_playwright() as p:
    browser = p.chromium.launch(headless=False)
    page = browser.new_page()
    page.goto("https://www.toptal.com/developers/keycode")
    page.wait_for_timeout(2000)
    # 按下a键盘
    page.keyboard.press("A")
    page.wait_for_timeout(2000)
    # 按下左键
    page.keyboard.press("Enter")
    page.wait_for_timeout(2000)
    # 按下o键
    page.keyboard.press("O")
    page.wait_for_timeout(2000)
    # 关闭
    browser.close()
```

#### 4）使用键盘进行文本输入
+ `keyboard.type("输入内容")`

```python
from playwright.sync_api import sync_playwright

with sync_playwright() as p:
    browser = p.chromium.launch(headless=False)
    page = browser.new_page()
    page.goto("https://www.baidu.com")
    page.wait_for_timeout(2000)
    page.locator("//*[@id='kw']").focus()
    page.wait_for_timeout(2000)
    page.keyboard.type("1234567890")
```

**参数：**

+ `<font style="background-color:rgb(243, 244, 244);">key</font>` : 要输入到焦点元素中的文本。



