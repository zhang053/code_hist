在掌握了 Playwright 的基本使用方法后，下一步我们将运用这一工具来抓取猫眼电影网站上的数据。本次实践的具体目标是获取猫眼电影 Top 100 榜单中的电影数据信息。

### 15.5.1 案例需求
#### 1）目标网站
+ **网站名称**：猫眼电影
+ **具体页面**：Top 100 榜单

![图 15.5.1-1 猫眼电影](https://cdn.nlark.com/yuque/0/2025/png/32819200/1739014275949-a3fda5ea-7669-4765-bbd4-14f53bb58640.png)

#### 2）采集数据要求
我们需要从每个电影条目中提取以下信息：

    - **电影名称**：电影的正式名称。
    - **上映时间**：该电影首次公开放映的日期。
    - **主演**：参与该电影的主要演员名单。
    - **评分**：观众或专业影评人对该电影的整体评价分数。

### 15.5.2 **分析网页结构**
明确需求之后，我们打开猫眼电影 Top 100 榜单页面，使用浏览器开发者工具 F12（ Chrome DevTools）查看页面元素结构，我们可以发现所有的电影数据都是包含在 `id=app` 这个 div 里面。而每部电影的数据都在 class 属性为` board-card clearfix `这个元素里面，如图 15.5.2-1 所示。

![图15.5.2-1 分析结构](https://cdn.nlark.com/yuque/0/2025/png/32819200/1739014886380-2e0f1ab5-9f85-46ef-8f90-f064c595a9c6.png)

### 15.5.3 实现过程
因为我们使用的是 playwright，所以不需要考虑这个页面是静态页面，还是动态渲染数据的页面，直接写 xpath 定位所有包含定义的元素即可，然后再遍历出来元素，最后通过`inner_text` 方法获取元素的文本内容。实现代码如下：

```python
from playwright.sync_api import sync_playwright
with sync_playwright()as p:
    browser = p.chromium.launch(headless=False)
    page = browser.new_page()
    page.goto('https://m.maoyan.com/asgard/board/4')
    # 对于页面中出现懒加载的内容，需要滚动鼠标到可见时才会加载出来，我们需要模拟滚动鼠标
    div_list = page.locator('//div[@class="board-card clearfix"]')
    print(div)
```

运行结果如下：

```python
['1\n我不是药神\n徐峥,王传君,周一围\n2018-07-05\n9.6分', 
'2\n肖申克的救赎\n蒂姆·罗宾斯,摩根·弗里曼,鲍勃·冈顿\n1994-09-10(加拿大)\n9.5分', 
'3\n海上钢琴师\n蒂姆·罗斯,比尔·努恩 ,克兰伦斯·威廉姆斯三世\n2019-11-15\n9.3分',
 '4\n绿皮书\n维果·莫腾森,马赫沙拉·阿里,琳达·卡德里尼\n2019-03-01\n9.5分', 
'5\n霸王别姬\n张国荣,张丰毅,巩俐\n1993-07-26\n9.4分',
 ......
 '99\n模仿游戏\n本尼迪克特·康伯巴奇,凯拉·奈特莉,马修·古迪\n2015-07-21\n9.3分',
 '100\n鬼子来了\n姜文,姜宏波,陈强\n2000-05-13(法国)\n8.9分']
```

运行会得到一个保存所有电影数据的列表，其中每部电影的数据是列表中的一个元素，通过分析可以发现每部电影数据的特点，每个字段是通过 \n 分隔开的，那么我们只需要把数据遍历出来，然后对数据简单处理一下就可以得到想要的字段数据,下面是对数据进行处理的代码：

```python
from playwright.sync_api import sync_playwright
with sync_playwright()as p:
    browser = p.chromium.launch(headless=False)
    page = browser.new_page()
    page.goto('https://m.maoyan.com/asgard/board/4')
    # 对于页面中出现懒加载的内容，需要滚动鼠标到可见时才会加载出来，我们需要模拟滚动鼠标
    div_list = page.locator('//div[@class="board-card clearfix"]')
    datas = div_list.all_inner_texts()
    title = ["序号","电影名称","主演","上映时间","评分"]
    for item in datas:
        value = item.split('\n')
        res = dict(zip(title, value))
        print(res)

```

运行结果如下：

```python
{'序号': '1', '电影名称': '我不是药神', '主演': '徐峥,王传君,周一围', '上映时间': '2018-07-05', '评分': '9.6分'}
{'序号': '2', '电影名称': '肖申克的救赎', '主演': '蒂姆·罗宾斯,摩根·弗里曼,鲍勃·冈顿', '上映时间': '1994-09-10(加拿大)', '评分': '9.5分'}
{'序号': '3', '电影名称': '海上钢琴师', '主演': '蒂姆·罗斯,比尔·努恩 ,克兰伦斯·威廉姆斯三世', '上映时间': '2019-11-15', '评分': '9.3分'}
{'序号': '4', '电影名称': '绿皮书', '主演': '维果·莫腾森,马赫沙拉·阿里,琳达·卡德里尼', '上映时间': '2019-03-01', '评分': '9.5分'}
{'序号': '5', '电影名称': '霸王别姬', '主演': '张国荣,张丰毅,巩俐', '上映时间': '1993-07-26', '评分': '9.4分'}
{'序号': '6', '电影名称': '美丽人生', '主演': '罗伯托·贝尼尼,朱斯蒂诺·杜拉诺,赛尔乔·比尼·布斯特里克', '上映时间': '2020-01-03', '评分': '9.3分'}
{'序号': '7', '电影名称': '这个杀手不太冷', '主演': '让·雷诺,娜塔莉·波特曼,加里·奥德曼', '上映时间': '2024-11-01', '评分': '9.6分'}
{'序号': '8', '电影名称': '星际穿越', '主演': '马修·麦康纳,安妮·海瑟薇,杰西卡·查斯坦', '上映时间': '2014-11-12', '评分': '9.3分'}
.....
{'序号': '99', '电影名称': '模仿游戏', '主演': '本尼迪克特·康伯巴奇,凯拉·奈特莉,马修·古迪', '上映时间': '2015-07-21', '评分': '9.3分'}
{'序号': '100', '电影名称': '鬼子来了', '主演': '姜文,姜宏波,陈强', '上映时间': '2000-05-13(法国)', '评分': '8.9分'}
```

