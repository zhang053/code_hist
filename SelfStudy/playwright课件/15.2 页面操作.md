### 15.2.1 页面基本操作
#### 1）打开页面
使用 `page.goto(url, referer='https://www.baidu.com')` 可以导航到指定的 URL。其中，`url` 参数是目标网页的地址，而 `referer` 参数用于设置 HTTP 请求头中的 Referer 字段，模拟从某个特定页面跳转过来的情况。此外，还可以通过设置其他选项来控制加载行为，例如：

+ `timeout`：设置超时时间（单位为毫秒）。
+ `wait_until`：指定等待加载完成的状态，例如 `'load'`、`'domcontentloaded'` 或 `'networkidle'`。  
示例代码：

```python
page.goto(url, referer='https://www.baidu.com', timeout=30000, wait_until='load')
```

#### 2）获取标题名称
`page.title()` 用于获取当前页面的标题文本。此方法返回一个字符串类型的值，代表浏览器标签页上显示的页面标题。  
示例代码：

```python
title = page.title()
print(f"页面标题: {title}")
```

#### 3）获取页面 HTML 源码
`page.content()` 能够读取整个页面的 HTML 内容并以字符串形式返回。这对于需要分析或验证页面结构非常有用。  
示例代码：

```python
html = page.content()
print(f"页面 HTML 源码: {html}")
```

#### 4）关闭页面
`page.close()` 会关闭当前页面实例。如果这是最后一个打开的页面，则浏览器上下文也会被销毁。注意，在某些情况下可能需要先保存重要数据再执行此操作。  
示例代码：

```python
page.close()
```

#### 5）页面截图
`page.screenshot(path='图片保存路径')` 允许将当前页面视图捕获为图像文件。`path` 参数指定了保存截图的位置及文件名。可以通过调整参数来自定义截图范围，例如：

+ `full_page`：是否截取整个页面。
+ `clip`：指定截图的裁剪区域。  
示例代码：

```python
page.screenshot(path='screenshot.png', full_page=True)
```

### 15.2.2 等待机制
Playwright 内置了智能等待机制，默认最大等待时间为 30 秒（即 30000 毫秒）。它能自动处理元素可见性、可点击性等问题，减少显式等待的需求。

#### 1）修改默认的等待时间
`page.set_default_timeout(timeout)` 用来更改全局默认的超时设置。这里的 `timeout` 单位为毫秒，一旦设定后会影响后续所有涉及等待的操作，除非再次调用该方法重置。  
示例代码：

```python
page.set_default_timeout(60000)  # 设置默认超时时间为 60 秒
```

#### 2）等待页面处于某种状态
`page.wait_for_load_state("load")` 用于确保页面达到特定加载状态后再继续执行下一步操作。Playwright 提供了三种加载状态：

+ `'load'`：等待 `load` 事件触发，意味着所有资源（包括图片、脚本等）均已加载完毕。
+ `'domcontentloaded'`：等待 `DOMContentLoaded` 事件触发，此时 HTML 文档已解析完成，DOM 树构建结束，但不包括外部资源（如图片）的加载。
+ `'networkidle'`：当网络空闲一段时间后触发，通常表示没有正在进行的网络请求。不过官方建议尽量避免使用此状态，因为它依赖于网络状况且不够稳定。  
示例代码：

```python
page.wait_for_load_state('load')
```

#### 3）等待页面跳转到指定的 URL 地址
`page.wait_for_url("**/target.html")` 会在页面导航至与给定模式匹配的目标 URL 时暂停程序执行。星号 `*` 作为通配符可用于匹配任意字符序列，使得规则更加灵活。  
示例代码：

```python
page.wait_for_url("**/target.html")
```

#### 4）等待指定的时间
`page.wait_for_timeout(10000)` 强制等待指定毫秒数（这里是 10 秒），适用于那些确实需要固定延时的场景。然而，在大多数情况下应优先考虑基于条件的等待方式，因为它们更可靠且效率更高。  
示例代码：

```python
page.wait_for_timeout(10000)
```

通过这些基本操作和等待机制，你可以有效地控制和管理 Playwright 中的页面行为，确保自动化任务的顺利进行。

