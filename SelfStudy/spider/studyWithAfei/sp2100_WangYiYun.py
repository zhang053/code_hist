import requests
import subprocess
import json

cookies = {
    "_iuqxldmzr_": "32",
    "_ntes_nnid": "a0730fbda5ece6814c04a3d71aee7c94,1762699641556",
    "_ntes_nuid": "a0730fbda5ece6814c04a3d71aee7c94",
    "NMTID": "00OJP_FrNd8Q3dnpUXTs8Fe0p6l-hQAAAGaaRYEiw",
    "WEVNSM": "1.0.0",
    "WNMCID": "nmagvj.1762699642056.01.0",
    "WM_TID": "aFamwQQF%2FU5BRAUFEFPGzX3DR2wVb%2FpZ",
    "__snaker__id": "61sZkbqHwlU7bTDd",
    "gdxidpyhxdE": "M9iX4e8J9089Pe3BZYvw3%2F0vlcGO1r4OUHs5zyQt1D0O5lISWu7bE%2FaBIvWCtEyYb4N17wp7VEkjrammbyBte8dLhuptDgbmIDHPVvPX8NcUDC41cWRq%5CcHfKJ5vrh994dgjfjrnzHsEzKeJA%2FRP0XNI3SXrcU4nPOY3%2FbiXr4J8hhJK%3A1762700545278",
    "sDeviceId": "YD-hdFq5I0Q4JVFU0EFRBKWmGyDEz1WHV%2Bk",
    "ntes_utid": "tid._.mg9qRg%252FN%252FQ9AAxVRBReD3SyWAnxSHB%252F1._.0",
    "MUSIC_U": "008789A749524F8AA8D7687A6EB21AE0476465C775AA7FC524BAB1E8A4AEE5E23B1DAD5FED20CD71EB7FB5A1AC7EA6AA242E0FCF83986D87C954343F150D83A22EC8DA6205B30C47EF3B68CAA331C1BAD906B30E0B2531CB863CEEF878FDBF2FB1FDB7A9BB460F0074CA6C24F19A21CD0831AE9488D5F885222DB566D5FB83DDEE4AAD8A2F36414F77E51F5201F9294FE189B35EDF6223AE5C0CE5A973835D1BB50215F3B1C39F97D417D2EB9220F1AAF0F1F051329BC8D70E4FA83F6239C9441F9B74B919844A50688517BC8DB31495E6FF1D131239E6118C47463F50911DAA767D8F07461B28599308D1CC3BE2E65CA7F11E1C42D89DD4E3E27196ABB5520C72F3F46F10F63DC83CD5933412E33068C8A79B031AC7881FD9832CD8E60D2D6DE89250E1234CC8ED7CADE72F9426C82AAABDDBBB56AFBFB835D31C4A49BDD5461F5041F40C60CF289B6BE196B65E33F5B631026E601B68DFDE902CCA106F24D8E760CDE4543A13735C65B021F4389ABEF7D8D191AFCDF107CD176D5D320FEC213672230AB5F0DC21D4CF4777454C88E3E3BCA5CE59183DF170D5ED810D394F7CFA061EC8FE08BABC093E260BF39B8A4654",
    "__remember_me": "true",
    "__csrf": "b33a4fcd9f739f98892dc8cc4cde96a8",
    "P_INFO": "15941075531|1762699726|1|music|00&99|null&null&null#JP&null#10#0|&0||15941075531",
    "ntes_kaola_ad": "1",
    "WM_NI": "%2BZkHMc%2B%2FgcjX6u7LllNuWufirXlQQt7ZUEKhO6Bycr40i1IjeBZUIbWqxKSx64b%2BZnUacYHZdSZ9OK%2BrNLcAbCB5lLsalXgbDerc0C8TC4QjktWdlFmy8F71MVJ97lvOT00%3D",
    "WM_NIKE": "9ca17ae2e6ffcda170e2e6eebaea708fb6fbd4d869a8ef8aa2d14a878a9eadd6629cb182d4cd49fc92b7dadb2af0fea7c3b92ae986a5a9d069e9f1a984e954f6abf9adef688eab9996e563b288a4b2d480f5869ba6ca648dea8e9ae27af8f0a7d2cc62a79e96b6cc6a95afb8acd274f6ecaeccd96697bfadbacb52a88d96dace41e9ae82ade24ba29d8ed6ef48b1bfa4b9e66a88bbbe84b349fc8c8dd5d462a9ac9985ef4eafa7f8a7b63b8f8a86dab668b6919cd1b337e2a3",
    "JSESSIONID-WYYY": "62R8v1NW4V%2FhNZoikpxsl8Nr4kJhTxCVr%2Fsub7rb853WcAsIjn1CQue8AyxjatbSh5SZDAnWtIX7KdNSeCNDvWupEvt3Ne1CJhefFycxnc187e0h7ZBrZa7Rzobvc6OttejzbGX8uXUUeDetP5WhDxf%2BNcbHBza%2F%5CJD5YZxpS%2BJRzoXU%3A1762867277709",
}

headers = {
    "accept": "*/*",
    "accept-language": "ja,en;q=0.9,en-GB;q=0.8,en-US;q=0.7,zh-CN;q=0.6,zh;q=0.5",
    "cache-control": "no-cache",
    "content-type": "application/x-www-form-urlencoded",
    "nm-gcore-status": "1",
    "origin": "https://music.163.com",
    "pragma": "no-cache",
    "priority": "u=1, i",
    "referer": "https://music.163.com/song?id=1953104779",
    "sec-ch-ua": '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"',
    "sec-ch-ua-mobile": "?0",
    "sec-ch-ua-platform": '"Windows"',
    "sec-fetch-dest": "empty",
    "sec-fetch-mode": "cors",
    "sec-fetch-site": "same-origin",
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0",
    # 'cookie': '_iuqxldmzr_=32; _ntes_nnid=a0730fbda5ece6814c04a3d71aee7c94,1762699641556; _ntes_nuid=a0730fbda5ece6814c04a3d71aee7c94; NMTID=00OJP_FrNd8Q3dnpUXTs8Fe0p6l-hQAAAGaaRYEiw; WEVNSM=1.0.0; WNMCID=nmagvj.1762699642056.01.0; WM_TID=aFamwQQF%2FU5BRAUFEFPGzX3DR2wVb%2FpZ; __snaker__id=61sZkbqHwlU7bTDd; gdxidpyhxdE=M9iX4e8J9089Pe3BZYvw3%2F0vlcGO1r4OUHs5zyQt1D0O5lISWu7bE%2FaBIvWCtEyYb4N17wp7VEkjrammbyBte8dLhuptDgbmIDHPVvPX8NcUDC41cWRq%5CcHfKJ5vrh994dgjfjrnzHsEzKeJA%2FRP0XNI3SXrcU4nPOY3%2FbiXr4J8hhJK%3A1762700545278; sDeviceId=YD-hdFq5I0Q4JVFU0EFRBKWmGyDEz1WHV%2Bk; ntes_utid=tid._.mg9qRg%252FN%252FQ9AAxVRBReD3SyWAnxSHB%252F1._.0; MUSIC_U=008789A749524F8AA8D7687A6EB21AE0476465C775AA7FC524BAB1E8A4AEE5E23B1DAD5FED20CD71EB7FB5A1AC7EA6AA242E0FCF83986D87C954343F150D83A22EC8DA6205B30C47EF3B68CAA331C1BAD906B30E0B2531CB863CEEF878FDBF2FB1FDB7A9BB460F0074CA6C24F19A21CD0831AE9488D5F885222DB566D5FB83DDEE4AAD8A2F36414F77E51F5201F9294FE189B35EDF6223AE5C0CE5A973835D1BB50215F3B1C39F97D417D2EB9220F1AAF0F1F051329BC8D70E4FA83F6239C9441F9B74B919844A50688517BC8DB31495E6FF1D131239E6118C47463F50911DAA767D8F07461B28599308D1CC3BE2E65CA7F11E1C42D89DD4E3E27196ABB5520C72F3F46F10F63DC83CD5933412E33068C8A79B031AC7881FD9832CD8E60D2D6DE89250E1234CC8ED7CADE72F9426C82AAABDDBBB56AFBFB835D31C4A49BDD5461F5041F40C60CF289B6BE196B65E33F5B631026E601B68DFDE902CCA106F24D8E760CDE4543A13735C65B021F4389ABEF7D8D191AFCDF107CD176D5D320FEC213672230AB5F0DC21D4CF4777454C88E3E3BCA5CE59183DF170D5ED810D394F7CFA061EC8FE08BABC093E260BF39B8A4654; __remember_me=true; __csrf=b33a4fcd9f739f98892dc8cc4cde96a8; P_INFO=15941075531|1762699726|1|music|00&99|null&null&null#JP&null#10#0|&0||15941075531; ntes_kaola_ad=1; WM_NI=%2BZkHMc%2B%2FgcjX6u7LllNuWufirXlQQt7ZUEKhO6Bycr40i1IjeBZUIbWqxKSx64b%2BZnUacYHZdSZ9OK%2BrNLcAbCB5lLsalXgbDerc0C8TC4QjktWdlFmy8F71MVJ97lvOT00%3D; WM_NIKE=9ca17ae2e6ffcda170e2e6eebaea708fb6fbd4d869a8ef8aa2d14a878a9eadd6629cb182d4cd49fc92b7dadb2af0fea7c3b92ae986a5a9d069e9f1a984e954f6abf9adef688eab9996e563b288a4b2d480f5869ba6ca648dea8e9ae27af8f0a7d2cc62a79e96b6cc6a95afb8acd274f6ecaeccd96697bfadbacb52a88d96dace41e9ae82ade24ba29d8ed6ef48b1bfa4b9e66a88bbbe84b349fc8c8dd5d462a9ac9985ef4eafa7f8a7b63b8f8a86dab668b6919cd1b337e2a3; JSESSIONID-WYYY=62R8v1NW4V%2FhNZoikpxsl8Nr4kJhTxCVr%2Fsub7rb853WcAsIjn1CQue8AyxjatbSh5SZDAnWtIX7KdNSeCNDvWupEvt3Ne1CJhefFycxnc187e0h7ZBrZa7Rzobvc6OttejzbGX8uXUUeDetP5WhDxf%2BNcbHBza%2F%5CJD5YZxpS%2BJRzoXU%3A1762867277709',
}

params = {
    "csrf_token": "b33a4fcd9f739f98892dc8cc4cde96a8",
}

cursor = "-1"
for i in range(10):
    result = subprocess.run(
        ["node", "sp2101_reverse_parms.js", "1", cursor],
        capture_output=True,
        text=True,
        encoding="utf-8",
    )
    result = result.stdout.strip()
    # print(result)

    data = json.loads(result)

    response = requests.post(
        "https://music.163.com/weapi/comment/resource/comments/get",
        params=params,
        cookies=cookies,
        headers=headers,
        data=data,
    )

    print(response)
    r = response.json()
    # print(r)
    comments = r["data"]["comments"]
    cursor = str(r["data"]["cursor"])

    print("=" * 30, f"第{i}页", "=" * 30, "START!")
    for comment in comments:
        print("用户：", comment["user"]["nickname"])
        print("内容：", comment["content"])
        print("日期：", comment["time"])
        print("-" * 30)
    print("=" * 10, f"第{i}页", "=" * 10, "END!")
